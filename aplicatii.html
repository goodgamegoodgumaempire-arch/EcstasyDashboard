<!-- Card aplicație Staff -->
<div class="card">
  <h2>Aplică pentru Staff</h2>
  <button onclick="toggleForm('staff')">Aplică</button>
  <div id="formstaff" class="hidden" data-loaded="false"></div>
</div>

<script>
let aplicatii = JSON.parse(localStorage.getItem("aplicatii")) || [];

// Toggle form și generează câmpuri din model
function toggleForm(tip){
  const div = document.getElementById("form"+tip);

  if(div.dataset.loaded !== "true"){
    let model = [];
    if(tip==="politie") model = JSON.parse(localStorage.getItem("modelPolitie")) || ["Nume jucător","Motivație / Mesaj"];
    if(tip==="medici") model = JSON.parse(localStorage.getItem("modelMedici")) || ["Nume jucător","Motivație / Mesaj"];
    if(tip==="staff") model = JSON.parse(localStorage.getItem("modelStaff")) || ["Nume jucător","Motivație / Mesaj"];

    div.innerHTML = "";

    model.forEach(field => {
      const card = document.createElement("div");
      card.className = "card";
      const label = document.createElement("label");
      label.innerText = field;
      const el = field.toLowerCase().includes("mesaj") ? document.createElement("textarea") : document.createElement("input");
      el.dataset.field = field;
      card.appendChild(label);
      card.appendChild(el);
      div.appendChild(card);
    });

    const submitBtn = document.createElement("button");
    submitBtn.innerText = "Trimite aplicație";
    submitBtn.onclick = ()=> trimiteAplicatie(tip);
    div.appendChild(submitBtn);

    div.dataset.loaded = "true";
  }

  div.style.display = (div.style.display==="block") ? "none" : "block";
}

// Trimite aplicație
function trimiteAplicatie(tip){
  const div = document.getElementById("form"+tip);
  const inputs = Array.from(div.querySelectorAll("input,textarea"));
  const values = inputs.map(i=>i.value.trim());

  if(values.some(v=>v==="")) { alert("Completează toate câmpurile!"); return; }

  aplicatii.push({
    type: tip,
    name: values[0],
    answers: values,
    status: "În așteptare"
  });
  localStorage.setItem("aplicatii", JSON.stringify(aplicatii));
  alert("Aplicația a fost trimisă!");

  inputs.forEach(i=>i.value="");
  div.style.display = "none";

  renderAplicatii();
}

// Render aplicații trimise
function renderAplicatii(){
  const container = document.getElementById("aplicatiiList");
  container.innerHTML = "";
  aplicatii.forEach((a,i)=>{
    const div = document.createElement("div");
    div.className = "item card";
    let content = `<strong>${a.name}</strong> [${a.type}]<br>`;
    if(a.answers){
      a.answers.forEach((ans,j)=>{
        content += `Întrebare ${j+1}: ${ans}<br>`;
      });
    }
    content += `<span class="status">${a.status}</span>`;
    div.innerHTML = content;
    container.appendChild(div);
  });
}

renderAplicatii();
</script>

<head>
  ...
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
<nav>
  <img src="logo.png" alt="G4A Logo">
  <ul>
    <li><a href="index.html">Acasă</a></li>
    <li class="active"><a href="aplicatii.html">Aplicații</a></li>
    <li><a href="reclamatii_staff.html">Reclamații Staff</a></li>
    <li id="userStatus" style="margin-left:auto;color:#ff6600;"></li>
  </ul>
</nav>

<script>
  // Config Firebase
  const firebaseConfig = {
    apiKey: "API_KEY",
    authDomain: "PROJECT_ID.firebaseapp.com",
    databaseURL: "https://PROJECT_ID.firebaseio.com",
    projectId: "PROJECT_ID",
    storageBucket: "PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.database();
  const userStatus = document.getElementById('userStatus');
  let currentUser = null;

  // Ascultă schimbarea autentificării
  auth.onAuthStateChanged(user => {
    if(user){
      currentUser = user;
      userStatus.textContent = `Salut, ${user.email}`;
      loadAplicatiiFirebase();
    } else {
      currentUser = null;
      userStatus.textContent = 'Nu ești logat';
    }
  });

  // Trimite aplicație în Firebase
  function trimiteAplicatie(tip){
    if(!currentUser){
      alert("Trebuie să fii logat pentru a trimite aplicații!");
      return;
    }

    const div = document.getElementById("form"+tip);
    const inputs = Array.from(div.querySelectorAll("input,textarea"));
    const values = inputs.map(i=>i.value.trim());
    if(values.some(v=>v==="")) { alert("Completează toate câmpurile!"); return; }

    const obj = {type: tip, name: values[0], answers: values, status:"În așteptare"};

    db.ref('aplicatii/' + currentUser.uid).push(obj)
      .then(()=>{
        alert("Aplicația a fost trimisă!");
        inputs.forEach(i=>i.value="");
        div.style.display="none";
        loadAplicatiiFirebase();
      })
      .catch(err=>alert("Eroare: "+err.message));
  }

  // Încarcă aplicațiile din Firebase
  function loadAplicatiiFirebase(){
    if(!currentUser) return;
    const container = document.getElementById("aplicatiiList");
    container.innerHTML = "";
    db.ref('aplicatii/' + currentUser.uid).once('value', snapshot=>{
      snapshot.forEach(child=>{
        const a = child.val();
        const div = document.createElement("div");
        div.className = "item";
        let content = `<strong>${a.name}</strong> [${a.type}]<br>`;
        if(a.answers){
          let model = [];
          if(a.type==="politie") model = ["Nume jucător","Motivație / Mesaj"];
          if(a.type==="medici") model = ["Nume jucător","Motivație / Mesaj"];
          if(a.type==="staffNou") model = ["Nume jucător","Motivație / Mesaj","Experiență relevantă"];
          a.answers.forEach((ans,i)=>{
            content += `<strong>${model[i] || "Întrebare "+(i+1)}:</strong> ${ans}<br>`;
          });
        }
        content += `<span class="status">${a.status}</span>`;
        div.innerHTML = content;
        container.appendChild(div);
      });
    });
  }
</script>

<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forum - G4A Romania</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { margin:0; font-family:'Roboto',sans-serif; background: linear-gradient(135deg,#0b0c17,#1b1f38,#4fc3f7,#0b0c17); background-size:400% 400%; animation: gradientBG 20s ease infinite; color:#fff; min-height:100vh;}
@keyframes gradientBG {0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
#authContainer { display:flex; flex-direction:column; justify-content:center; align-items:center; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); z-index:1000; padding:20px; box-sizing:border-box;}
#authContainer input { padding:10px; margin:5px 0; border-radius:8px; border:none; width:250px; }
#authContainer button { padding:10px 20px; margin:5px; border:none; border-radius:8px; font-weight:700; cursor:pointer; background:#4fc3f7; color:#0b0c17; }
#authContainer button:hover { background:#ffdd57; }
#content { display:none; padding:20px;}
.card { background: rgba(17,17,17,0.85); border-radius: 10px; padding: 20px; margin: 15px 0; border: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
</style>
</head>
<body>

<div id="authContainer">
  <h2>Autentificare / Înregistrare</h2>
  <input type="text" id="displayName" placeholder="Nume de utilizator">
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Parola">
  <div>
    <button id="loginBtn">Loghează-te</button>
    <button id="signupBtn">Înregistrează-te</button>
  </div>
</div>

<div id="content">
  <h1>Bine ai venit!</h1>

  <!-- Card invizibil admin -->
  <div class="card" id="adminCard" style="display:none;">
      <h2>Zona Administrativa</h2>
      <p>Aceasta este zona pentru administratori.</p>
      <a href="admin.html" style="color:#ff6600;">Acceseaza Admin Panel</a>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ================== Firebase Config ==================
const firebaseConfig = {
  apiKey: "AIzaSyA40DfthDKIy812oujRj2JLLg1Y_dCvJvI",
  authDomain: "ecstassy-44277.firebaseapp.com",
  databaseURL: "https://ecstassy-44277-default-rtdb.firebaseio.com",
  projectId: "ecstassy-44277",
  storageBucket: "ecstassy-44277.firebasestorage.app",
  messagingSenderId: "557171186889",
  appId: "1:557171186889:web:0cae151137b761b2660118",
  measurementId: "G-34Q8PVK8EH"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// ================== User Auth ==================
const authContainer = document.getElementById("authContainer");
const content = document.getElementById("content");

auth.onAuthStateChanged(user => {
  if(user){
    authContainer.style.display="none";
    content.style.display="block";
  } else {
    authContainer.style.display="flex";
    content.style.display="none";
  }
});

document.getElementById("signupBtn").addEventListener("click", ()=>{
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const displayName = document.getElementById("displayName").value.trim();
  if(!displayName){ alert("Trebuie să introduci un nume!"); return; }
  auth.createUserWithEmailAndPassword(email,password)
    .then(userCredential=>{
      return userCredential.user.updateProfile({displayName}).then(()=>{
        db.ref('users/'+userCredential.user.uid).set({username:displayName,email});
      });
    })
    .catch(e=>alert(e.message));
});

document.getElementById("loginBtn").addEventListener("click", ()=>{
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  auth.signInWithEmailAndPassword(email,password).catch(e=>alert(e.message));
});

function logout(){ auth.signOut(); }

// ================== Admin Access cu Discord Webhook ==================
const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1417765822352588894/ujtSBGE4sD532iOe31sQiJ9NWXBSZuwc8EpwcFYM2sJg60XDqhXPzaTb5DET0jWrT2bW";
let parolaCurenta = "";

// Genereaza parola random
function genereazaParola(length=12){
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+[]{}|;:,.<>?";
  let parola = "";
  for(let i=0;i<length;i++){
    parola += chars.charAt(Math.floor(Math.random()*chars.length));
  }
  return parola;
}

// Trimite parola pe Discord
function trimiteWebhook(parola){
  fetch(DISCORD_WEBHOOK,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ content: `Noua parola admin: ${parola}` })
  });
}

// Actualizeaza parola la fiecare 30 minute
function actualizeazaParola(){
  parolaCurenta = genereazaParola(12);
  trimiteWebhook(parolaCurenta);
  console.log("Parola admin actualizata:", parolaCurenta);
}
actualizeazaParola();
setInterval(actualizeazaParola,30*60*1000);

// F9 pentru acces admin
document.addEventListener("keydown", function(e){
  if(e.key === "F9"){
    e.preventDefault();
    const parolaIntrodu = prompt("Introdu parola de administrator:");
    if(parolaIntrodu === null) return;
    if(parolaIntrodu === parolaCurenta){
      alert("Parola corecta! Acces la admin activat.");
      document.getElementById("adminCard").style.display="block";
    } else {
      alert("Parola incorecta!");
    }
  }
});
</script>
</body>
</html>
